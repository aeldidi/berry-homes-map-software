<!DOCTYPE html>

<head>
        <title>Real Estate Map Demo</title>

        <style>
                .hidden {
                        display: none;
                }
        </style>

        <script>
                window.onload = main

                // There are 112 numbers
                const number_to_point = [
                        // First block
                        [321, 153], [384, 150], [445, 149], [500, 152],
                        [548, 156], [591, 159], [604, 229], [617, 186],
                        [634, 148], [723, 144], [793, 157], [804, 208],
                        [799, 255], [873, 266], [874, 246], [864, 221],
                        [858, 202], [827, 161], [857, 143], [890, 139],
                        [923, 141], [947, 163], [960, 193], [930, 219],
                        [926, 241], [925, 261], [929, 283], [927, 314],
                        [926, 335], [927, 355], [928, 373], [927, 396],
                        [930, 417],

                        // Second Block
                        [284, 273], [309, 273], [328, 273], [351, 271],
                        [373, 271], [393, 272], [412, 273], [432, 275],
                        [453, 279], [472, 284], [492, 289], [511, 295],
                        [530, 303], [559, 314], [577, 326], [598, 334],
                        [620, 341], [642, 345], [666, 348], [690, 350],
                        [710, 351], [731, 351], [751, 351], [774, 352],
                        [794, 354], [811, 352], [834, 355], [855, 354],
                        [876, 356], [877, 378], [852, 377], [830, 379],
                        [808, 375], [782, 373], [760, 373], [738, 372],
                        [714, 371], [693, 373], [670, 371], [650, 370],
                        [630, 368], [608, 361], [588, 353], [568, 345],
                        [548, 337], [517, 322], [496, 312], [471, 308],
                        [447, 302], [423, 298], [399, 295], [373, 295],
                        [351, 294], [330, 294], [305, 296], [284, 294],

                        // Third Block
                        [310, 421], [333, 420], [357, 422], [382, 420],
                        [407, 422], [427, 424], [449, 430], [470, 436],
                        [502, 452], [523, 461], [543, 470], [570, 477],
                        [595, 483], [620, 490], [646, 491], [670, 494],
                        [692, 495], [714, 496], [736, 498], [760, 500],
                        [784, 498], [806, 501], [831, 501], [849, 500]
                ];

                function drawCircle(canvas, x, y, radius) {
                        canvas.beginPath();
                        canvas.arc(x, y, radius, 0, 2 * Math.PI, false);
                        canvas.fillStyle = 'red';
                        canvas.fill();
                        canvas.lineWidth = 5;
                        canvas.strokeStyle = 'red';
                        canvas.stroke();
                }

                async function main() {
                        let elem = document.querySelector('#canvas')
                        let img = document.images[0]
                        let canvas = elem.getContext('2d')

                        elem.width = img.width
                        elem.height = img.height
                        canvas.drawImage(document.images[0], 0, 0)
                        let data = await fetch('https://test-sheet.eldidi.org/api')
                        data = await data.json()

                        for (const [key, value] of Object.entries(data)) {
                                console.log(value)
                                if (value != 'SOLD') {
                                        continue
                                }

                                let num = parseInt(key)
                                let [x, y] = number_to_point[num]
                                drawCircle(canvas, x, y, 5)
                        }
                }
        </script>
</head>

<body>
        <img class="hidden" src="/Churchill_Meadows.png" />
        <canvas id="canvas"></canvas>
</body>